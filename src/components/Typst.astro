---
import { renderToSVGString, type TypstDocInput } from "../lib/typst.js";

export type Props = (
    | { code: string }
    | { src: string }
    | { input: TypstDocInput }
) &
    TypstOptions;

export type TypstOptions = {
    /**
     * Whether to add default style for anchors to function.
     *
     * If you have multiple svg elements in the same page,
     * you may want to set this to `false`, and import
     * the stylesheet manually.
     *
     * @default true
     */
    style?: boolean;
    /** @default "auto" */
    width?: number;
    /** @default "auto" */
    height?: number;
    /** @default 16 */
    remPx?: number;
    /** @default 2 */
    scale?: number;
};

const options = Astro.props;
let input: TypstDocInput =
    "src" in options
        ? { mainFilePath: options.src }
        : "code" in options
          ? options.code
          : options.input;

const svg = await renderToSVGString(input, options);
---

<div set:html={svg} />
